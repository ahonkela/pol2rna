To generate the necessary data files for GP modeling, use the following steps. 
Note: you may need to edit file paths mentioned in the code to correspond to 
locations where you have stored the code and data files.


--------------------------
Part 1: getting gene areas
--------------------------
1a. Run create_newbininfo.R and concatenate the output text files (without the 
header lines) into genes_dec2012_all.txt

1b. Run create_newbininfo_part2.m to create bininfo_dec2012.mat


--------------------------------------------------------------------
Part 2: editing gene areas to correspond to active mRNA transcripts 
--------------------------------------------------------------------
2a. Get the data files active_transcripts.txt and transcript_exonpos.txt as follows:

   The data file active_transcripts.txt is a processed form of mRNA activity 
   and is provided as a supplement to the manuscript.

   The file transcript_exonpos.txt can be generated from Biomart
   ( http://oct2012.archive.ensembl.org/biomart/martview ) with the following steps:
   -> Choose database: Ensembl genes 69
   -> Choose dataset: Homo sapiens
   -> Attributes
   -> Structures
   -> Exon; add: Exon Chr Start (bp),Exon Chr End (bp),Exon Rank in Transcript
   -> Results, format: CSV

2b. Run convert_exonpos.m to generate transcript_exonpos.mat

2c. Run check_exonstarts_part1.m and check_exonstarts_part2.m to generate problemgenes.mat 
(manually save the relevant fields generated by the code into problemgenes.mat)


-------------------------------------------------
Part 3: computing pol-II activity over gene areas
-------------------------------------------------
3a. Get the data files: 
MCF7_NoTreat_PolII_2012-03_unique.bed.gz
MCF7_5min_PolII_2012-03_unique.bed.gz
MCF7_10min_PolII_2012-03_unique.bed.gz
MCF7_20min_PolII_2012-03_unique.bed.gz
MCF7_40min_PolII_2012-03_unique.bed.gz
MCF7_80min_PolII_2012-03_unique.bed.gz
MCF7_160min_PolII_2012-03_unique.bed.gz
MCF7_320min_PolII_2012-03_unique.bed.gz
MCF7_640min_PolII_2012-03_unique.bed.gz
MCF7_1280min_PolII_2012-03_unique.bed.gz

3b. Run compute_pol2_binactivity_corrected_dec2012.m (which requires read_mappingfile.c, compute_pol2activityovergenes_c.c)
and uncomment the first part of the code (comment out the rest), to create
'pol0_2012_03.mat','pol5_2012_03.mat','pol10_2012_03.mat',
'pol20_2012_03.mat','pol40_2012_03.mat','pol80_2012_03.mat',
'pol160_2012_03.mat','pol320_2012_03.mat','pol640_2012_03.mat',
'pol1280_2012_03.mat'

3c. Comment out the first part of the code in compute_pol2_binactivity_corrected_dec2012.m and uncomment the rest,
to generate all_gene_pol2bins_2013_01_02.mat and bininfo_dec2012_corrected.mat


---------------------------------------------------------------------
Part 4: computing activity over visually determined inactive regions,
to be used later for noise removal
---------------------------------------------------------------------
4a. Get the data file empty_regions.txt which is provided as a supplement to the manuscript.

4b. Run compute_emptybins_pol2_corrected_sept2012.m (requires read_stringfile.m)
to generate all_empty_pol2bins_2012_09.mat


------------------------------------------------------------------
Part 5: perform noise removal, time point normalization, and final
summarization into time series
------------------------------------------------------------------
5. Run compute_pol2_summaryseries_corrected_dec2012.m to generate
pol2_summaryseries_2013_01_02.mat

